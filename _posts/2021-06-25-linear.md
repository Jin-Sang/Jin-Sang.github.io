---
layout: single
title:  "My Linear Analysis"

use_math: true

---
# Machine Learning


# **2020ë…„ ê¸°ì¤€ 1ì¸ë‹¹ GDPì™€ ì‚¶ì˜ ë§Œì¡±ë„ ê´€ê³„ ì„ í˜• ë¶„ì„**




---
# **ê¸°ë³¸ì„¤ì •**




```python
# íŒŒì´ì¬ ë²„ì „ â‰¥ 3.5
import sys
assert sys.version_info >= (3, 5)

# Scikit-Learn ë²„ì „ â‰¥0.20
import sklearn
assert sklearn.__version__ >= "0.20"
```

**ì£¼í”¼í„° ë…¸íŠ¸ë¶ì—ì„œ ê·¸ë˜í”„ë¥¼ ê¹”ê¸ˆí•˜ê²Œ ê·¸ë¦¬ê¸° ìœ„í•œ ì„¤ì •**


```python
%matplotlib inline 

import matplotlib as mpl
mpl.rc('axes', labelsize=14)
mpl.rc('xtick', labelsize=12)
mpl.rc('ytick', labelsize=12)
```

**í•„ìš”í•œ ëª¨ë“ˆ ë¶ˆëŸ¬ì˜¤ê¸°**



```python
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
```

**ê·¸ë˜í”„ ì €ì¥ í•¨ìˆ˜ ì„ ì–¸**


```python
import os

# ê·¸ë˜í”„ ì €ì¥ì„ ë””ë ‰í† ë¦¬ ì§€ì •
PROJECT_ROOT_DIR = "."
CHAPTER_ID = "fundamentals"
IMAGES_PATH = os.path.join(PROJECT_ROOT_DIR, "images", CHAPTER_ID)
os.makedirs(IMAGES_PATH, exist_ok=True)

# ê·¸ë˜í”„ ì €ì¥ í•¨ìˆ˜ ì„ ì–¸
def save_fig(fig_id, tight_layout=True, fig_extension="png", resolution=300):
    path = os.path.join(IMAGES_PATH, fig_id + "." + fig_extension)
    print("Saving figure", fig_id)
    if tight_layout:
        plt.tight_layout()
    plt.savefig(path, format=fig_extension, dpi=resolution)
```

**ë¬´ì‘ìœ„ ì‹œë“œ ì§€ì •**





```python
import numpy as np

np.random.seed(42)
```


# ë°ì´í„° ë‹¤ìš´ë¡œë“œ
---


**ë°ì´í„° ê²½ë¡œ ì„¤ì •**


```python
datapath = os.path.join("datasets", "lifesat", "")
```

**ë°ì´í„° ë‹¤ìš´ë¡œë“œ (oecd_bli_2020.csv, gdp_per_capita_2020.xlsx)**


```python
import urllib.request
DOWNLOAD_ROOT = "https://raw.githubusercontent.com/codingalzi/handson-ml/master/"
os.makedirs(datapath, exist_ok=True)
for filename in ("oecd_bli_2020.csv", "gdp_per_capita_2020.xlsx"):
    print("ë‹¤ìš´ë¡œë“œ:", filename)
    url = DOWNLOAD_ROOT + "notebooks/datasets/lifesat/" + filename
    urllib.request.urlretrieve(url, datapath + filename)

```

    ë‹¤ìš´ë¡œë“œ: oecd_bli_2020.csv
    ë‹¤ìš´ë¡œë“œ: gdp_per_capita_2020.xlsx
    

# ë°ì´í„° ì ì¬ì™€ ì¤€ë¹„

---


**ì‚¶ì˜ ë§Œì¡±ë„ ë°ì´í„° ì ì¬ì™€ ì¤€ë¹„**


```python
oecd_bli = pd.read_csv(datapath + "oecd_bli_2020.csv", thousands=',')
oecd_bli = oecd_bli[oecd_bli["INEQUALITY"]=="TOT"]
oecd_bli = oecd_bli.pivot(index="Country", columns="Indicator", values="Value")

# ì•ŒíŒŒë²³ ìˆœìœ¼ë¡œ ì²« 5ê°œ êµ­ê°€ ë°ì´í„° ë³´ì—¬ì£¼ê¸°
oecd_bli.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Indicator</th>
      <th>Air pollution</th>
      <th>Dwellings without basic facilities</th>
      <th>Educational attainment</th>
      <th>Employees working very long hours</th>
      <th>Employment rate</th>
      <th>Feeling safe walking alone at night</th>
      <th>Homicide rate</th>
      <th>Household net adjusted disposable income</th>
      <th>Household net wealth</th>
      <th>Housing expenditure</th>
      <th>Labour market insecurity</th>
      <th>Life expectancy</th>
      <th>Life satisfaction</th>
      <th>Long-term unemployment rate</th>
      <th>Personal earnings</th>
      <th>Quality of support network</th>
      <th>Rooms per person</th>
      <th>Self-reported health</th>
      <th>Stakeholder engagement for developing regulations</th>
      <th>Student skills</th>
      <th>Time devoted to leisure and personal care</th>
      <th>Voter turnout</th>
      <th>Water quality</th>
      <th>Years in education</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>5.0</td>
      <td>NaN</td>
      <td>81.0</td>
      <td>13.04</td>
      <td>73.0</td>
      <td>63.5</td>
      <td>1.1</td>
      <td>32759.0</td>
      <td>427064.0</td>
      <td>20.0</td>
      <td>5.4</td>
      <td>82.5</td>
      <td>7.3</td>
      <td>1.31</td>
      <td>49126.0</td>
      <td>95.0</td>
      <td>NaN</td>
      <td>85.0</td>
      <td>2.7</td>
      <td>502.0</td>
      <td>14.35</td>
      <td>91.0</td>
      <td>93.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>Austria</th>
      <td>16.0</td>
      <td>0.9</td>
      <td>85.0</td>
      <td>6.66</td>
      <td>72.0</td>
      <td>80.6</td>
      <td>0.5</td>
      <td>33541.0</td>
      <td>308325.0</td>
      <td>21.0</td>
      <td>3.5</td>
      <td>81.7</td>
      <td>7.1</td>
      <td>1.84</td>
      <td>50349.0</td>
      <td>92.0</td>
      <td>1.6</td>
      <td>70.0</td>
      <td>1.3</td>
      <td>492.0</td>
      <td>14.55</td>
      <td>80.0</td>
      <td>92.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>Belgium</th>
      <td>15.0</td>
      <td>1.9</td>
      <td>77.0</td>
      <td>4.75</td>
      <td>63.0</td>
      <td>70.1</td>
      <td>1.0</td>
      <td>30364.0</td>
      <td>386006.0</td>
      <td>21.0</td>
      <td>3.7</td>
      <td>81.5</td>
      <td>6.9</td>
      <td>3.54</td>
      <td>49675.0</td>
      <td>91.0</td>
      <td>2.2</td>
      <td>74.0</td>
      <td>2.0</td>
      <td>503.0</td>
      <td>15.70</td>
      <td>89.0</td>
      <td>84.0</td>
      <td>19.3</td>
    </tr>
    <tr>
      <th>Brazil</th>
      <td>10.0</td>
      <td>6.7</td>
      <td>49.0</td>
      <td>7.13</td>
      <td>61.0</td>
      <td>35.6</td>
      <td>26.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>74.8</td>
      <td>6.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.2</td>
      <td>395.0</td>
      <td>NaN</td>
      <td>79.0</td>
      <td>73.0</td>
      <td>16.2</td>
    </tr>
    <tr>
      <th>Canada</th>
      <td>7.0</td>
      <td>0.2</td>
      <td>91.0</td>
      <td>3.69</td>
      <td>73.0</td>
      <td>82.2</td>
      <td>1.3</td>
      <td>30854.0</td>
      <td>423849.0</td>
      <td>22.0</td>
      <td>6.0</td>
      <td>81.9</td>
      <td>7.4</td>
      <td>0.77</td>
      <td>47622.0</td>
      <td>93.0</td>
      <td>2.6</td>
      <td>88.0</td>
      <td>2.9</td>
      <td>523.0</td>
      <td>14.56</td>
      <td>68.0</td>
      <td>91.0</td>
      <td>17.3</td>
    </tr>
  </tbody>
</table>
</div>



**oecd 2020ë…„ë„ ì‚¶ì˜ ë§Œì¡±ë„ ë°ì´í„° í™•ì¸**


```python
oecd_bli["Life satisfaction"].head()
```




    Country
    Australia    7.3
    Austria      7.1
    Belgium      6.9
    Brazil       6.4
    Canada       7.4
    Name: Life satisfaction, dtype: float64



**1ì¸ë‹¹ GDP ë°ì´í„° ì ì¬ì™€ ì¤€ë¹„**


```python
gdp_per_capita = pd.read_excel(datapath+"gdp_per_capita_2020.xlsx", thousands=',', na_values="n/a")
gdp_per_capita.rename(columns={2020: "GDP per capita"}, inplace=True) # "2020" ì»¬ëŸ¼ ì´ë¦„ì„ "GDP per capita" ë¡œ ë³€ê²½ 
gdp_per_capita.set_index("Country", inplace=True)

# ì•ŒíŒŒë²³ ìˆœìœ¼ë¡œ ì²« 5ê°œ êµ­ê°€ GDP ì •ë³´ í™•ì¸
gdp_per_capita.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Subject Descriptor</th>
      <th>Units</th>
      <th>Scale</th>
      <th>Country/Series-specific Notes</th>
      <th>GDP per capita</th>
      <th>Estimates Start After</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afghanistan</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>499.441</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>Albania</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>4898.277</td>
      <td>2018.0</td>
    </tr>
    <tr>
      <th>Algeria</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>3331.076</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>Angola</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>2021.310</td>
      <td>2017.0</td>
    </tr>
    <tr>
      <th>Antigua and Barbuda</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>14158.571</td>
      <td>2011.0</td>
    </tr>
  </tbody>
</table>
</div>



**ë‘ ë°ì´í„°ì˜ ë³‘í•© (oecd ì‚¶ì˜ ë§Œì¡±ë„, 1ì¸ë‹¹ GDP)**


```python
full_country_stats = pd.merge(left=oecd_bli, right=gdp_per_capita, left_index=True, right_index=True)
```

**1ì¸ë‹¹ GDP ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ êµ­ê°€ë¥¼ ì •ë ¬ì‹œí‚µë‹ˆë‹¤.**


```python
full_country_stats.sort_values(by="GDP per capita", inplace=True) # 1ì¸ë‹¹ GDP ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬
```

**1ì¸ë‹¹ GDP ê¸°ì¤€ í•˜ìœ„ 3ê°œ êµ­ê°€ëŠ” ë‚¨ì•„ê³µ, ì½œë¡¬ë¹„ì•„, ë¸Œë¼ì§ˆì…ë‹ˆë‹¤.**


```python
full_country_stats.head(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Air pollution</th>
      <th>Dwellings without basic facilities</th>
      <th>Educational attainment</th>
      <th>Employees working very long hours</th>
      <th>Employment rate</th>
      <th>Feeling safe walking alone at night</th>
      <th>Homicide rate</th>
      <th>Household net adjusted disposable income</th>
      <th>Household net wealth</th>
      <th>Housing expenditure</th>
      <th>Labour market insecurity</th>
      <th>Life expectancy</th>
      <th>Life satisfaction</th>
      <th>Long-term unemployment rate</th>
      <th>Personal earnings</th>
      <th>Quality of support network</th>
      <th>Rooms per person</th>
      <th>Self-reported health</th>
      <th>Stakeholder engagement for developing regulations</th>
      <th>Student skills</th>
      <th>Time devoted to leisure and personal care</th>
      <th>Voter turnout</th>
      <th>Water quality</th>
      <th>Years in education</th>
      <th>Subject Descriptor</th>
      <th>Units</th>
      <th>Scale</th>
      <th>Country/Series-specific Notes</th>
      <th>GDP per capita</th>
      <th>Estimates Start After</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>South Africa</th>
      <td>22.0</td>
      <td>37.0</td>
      <td>73.0</td>
      <td>18.12</td>
      <td>43.0</td>
      <td>36.1</td>
      <td>13.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.0</td>
      <td>NaN</td>
      <td>57.5</td>
      <td>4.7</td>
      <td>16.46</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.92</td>
      <td>73.0</td>
      <td>67.0</td>
      <td>NaN</td>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>4735.747</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>Colombia</th>
      <td>10.0</td>
      <td>23.9</td>
      <td>54.0</td>
      <td>26.56</td>
      <td>67.0</td>
      <td>44.4</td>
      <td>24.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.0</td>
      <td>NaN</td>
      <td>76.2</td>
      <td>6.3</td>
      <td>0.79</td>
      <td>NaN</td>
      <td>89.0</td>
      <td>1.2</td>
      <td>NaN</td>
      <td>1.4</td>
      <td>410.0</td>
      <td>NaN</td>
      <td>53.0</td>
      <td>75.0</td>
      <td>14.1</td>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>5207.238</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>Brazil</th>
      <td>10.0</td>
      <td>6.7</td>
      <td>49.0</td>
      <td>7.13</td>
      <td>61.0</td>
      <td>35.6</td>
      <td>26.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>74.8</td>
      <td>6.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.2</td>
      <td>395.0</td>
      <td>NaN</td>
      <td>79.0</td>
      <td>73.0</td>
      <td>16.2</td>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>6450.451</td>
      <td>2019.0</td>
    </tr>
  </tbody>
</table>
</div>



**1ì¸ë‹¹ GDP ê¸°ì¤€ ìƒìœ„ 3ê°œ ì•„ì¼ëœë“œ, ìŠ¤ìœ„ìŠ¤, ë£©ì…ˆë¶€ë¥´í¬ ì…ë‹ˆë‹¤.**


```python
full_country_stats.tail(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Air pollution</th>
      <th>Dwellings without basic facilities</th>
      <th>Educational attainment</th>
      <th>Employees working very long hours</th>
      <th>Employment rate</th>
      <th>Feeling safe walking alone at night</th>
      <th>Homicide rate</th>
      <th>Household net adjusted disposable income</th>
      <th>Household net wealth</th>
      <th>Housing expenditure</th>
      <th>Labour market insecurity</th>
      <th>Life expectancy</th>
      <th>Life satisfaction</th>
      <th>Long-term unemployment rate</th>
      <th>Personal earnings</th>
      <th>Quality of support network</th>
      <th>Rooms per person</th>
      <th>Self-reported health</th>
      <th>Stakeholder engagement for developing regulations</th>
      <th>Student skills</th>
      <th>Time devoted to leisure and personal care</th>
      <th>Voter turnout</th>
      <th>Water quality</th>
      <th>Years in education</th>
      <th>Subject Descriptor</th>
      <th>Units</th>
      <th>Scale</th>
      <th>Country/Series-specific Notes</th>
      <th>GDP per capita</th>
      <th>Estimates Start After</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ireland</th>
      <td>7.0</td>
      <td>1.0</td>
      <td>82.0</td>
      <td>5.25</td>
      <td>67.0</td>
      <td>75.9</td>
      <td>0.7</td>
      <td>25310.0</td>
      <td>217130.0</td>
      <td>20.0</td>
      <td>7.8</td>
      <td>81.8</td>
      <td>7.0</td>
      <td>3.23</td>
      <td>47653.0</td>
      <td>95.0</td>
      <td>2.1</td>
      <td>83.0</td>
      <td>1.3</td>
      <td>509.0</td>
      <td>NaN</td>
      <td>65.0</td>
      <td>85.0</td>
      <td>18.1</td>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>79668.502</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>Switzerland</th>
      <td>15.0</td>
      <td>0.1</td>
      <td>88.0</td>
      <td>0.37</td>
      <td>80.0</td>
      <td>85.3</td>
      <td>0.6</td>
      <td>37466.0</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>83.7</td>
      <td>7.5</td>
      <td>1.82</td>
      <td>62283.0</td>
      <td>93.0</td>
      <td>1.9</td>
      <td>78.0</td>
      <td>2.3</td>
      <td>506.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>95.0</td>
      <td>17.5</td>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>81867.462</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>Luxembourg</th>
      <td>12.0</td>
      <td>0.5</td>
      <td>77.0</td>
      <td>3.82</td>
      <td>66.0</td>
      <td>75.8</td>
      <td>0.6</td>
      <td>39264.0</td>
      <td>769053.0</td>
      <td>21.0</td>
      <td>1.7</td>
      <td>82.8</td>
      <td>6.9</td>
      <td>2.35</td>
      <td>63062.0</td>
      <td>93.0</td>
      <td>1.9</td>
      <td>69.0</td>
      <td>1.7</td>
      <td>483.0</td>
      <td>NaN</td>
      <td>91.0</td>
      <td>84.0</td>
      <td>15.1</td>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>109602.322</td>
      <td>2018.0</td>
    </tr>
  </tbody>
</table>
</div>



# ë°ì´í„° ë¶„ì„

---
**ì‹œì‘í•˜ê¸° ì „ì— 7ê°œ ì œì™¸ êµ­ê°€**
- Columbia(ì½œë¡¬ë¹„ì•„)
- Brazil(ë¸Œë¼ì§ˆ)
- Mexico(ë©•ì‹œì½”)
- Chille(ì¹ ë ˆ)
- Ireland(ì•„ì¼ëœë“œ)
- Switzerland(ìŠ¤ìœ„ìŠ¤)
- Luxembourg(ë£©ì…ˆë¶€ë¥´í¬)



```python
# 7ê°œ êµ­ê°€ì˜ í–‰ ì¸ë±ìŠ¤ë¥¼ ì „ì²´ ì¸ë±ìŠ¤ ì§‘í•©ì—ì„œ ì œê±°
remove_indices = [1, 2, 4, 6, 37, 38, 39]
keep_indices = list(set(range(40)) - set(remove_indices))

# 7ê°œ êµ­ê°€ë¥¼ ì œì™¸í•œ êµ­ê°€ë“¤ì˜ 1ì¸ë‹¹ GDPì™€ ì‚¶ì˜ ë§Œì¡±ë„ ë°ì´í„°
sample_data = full_country_stats[["GDP per capita", 'Life satisfaction']].iloc[keep_indices] 

# ì œì™¸ëœ 7ê°œ êµ­ê°€ì˜ 1ì¸ë‹¹ GGPì™€ ì‚¶ì˜ ë§Œì¡±ë„ ë°ì´í„°
missing_data = full_country_stats[["GDP per capita", 'Life satisfaction']].iloc[remove_indices]
```


**ì œì™¸ëœ 7ê°œ êµ­ê°€ì˜ ë°ì´í„°ë¥¼ ì œì™¸í•œ êµ­ê°€ë“¤ì˜ 1ì¸ë‹¹ GDPì™€ ì‚¶ì˜ ë§Œì¡±ë„ ì‚¬ì´ì˜ ê´€ê³„ë¥¼ ì‚°ì ë„ë¡œ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.** 

**ë‹¤ë§Œ ì•„ë˜ì— ì–¸ê¸‰ëœ 5ê°œ êµ­ê°€ëŠ” ë¹¨ê°„ìƒ‰ ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.**

- í—ê°€ë¦¬(Hungary)
- ëŒ€í•œë¯¼êµ­(Korea)
- í”„ë‘ìŠ¤(France)
- í˜¸ì£¼(Australia)
- ë¯¸êµ­(United States)


```python
# 7ê°œ êµ­ê°€ë¥¼ ì œì™¸í•œ êµ­ê°€ë“¤ì˜ ë°ì´í„° ì‚°ì ë„
sample_data.plot(kind='scatter', x="GDP per capita", y='Life satisfaction', figsize=(5,3))
plt.axis([0, 65000, 0, 10])

# ì–¸ê¸‰ëœ 5ê°œ êµ­ê°€ëª… ëª…ê¸° ì¢Œí‘œ
position_text = {
  "Hungary": (8000, 1),
  "Korea": (26000, 1.7),
  "France": (34000, 2.4),
  "Australia": (44000, 3.0),
  "United States": (60000, 3.8),
}

# 5ê°œ êµ­ê°€ëŠ” ì¢Œí‘œë¥¼ ì´ìš©í•˜ì—¬ ë¹¨ê°•ìƒ‰ ì ìœ¼ë¡œ í‘œê¸°
for country, pos_text in position_text.items():
    pos_data_x, pos_data_y = sample_data.loc[country]
    # 5ê°œ êµ­ê°€ëª… í‘œê¸°
    country = "U.S." if country == "United States" else country
    plt.annotate(country, xy=(pos_data_x, pos_data_y), xytext=pos_text,
            arrowprops=dict(facecolor='black', width=0.5, shrink=0.1, headwidth=5))
    # 5ê°œ êµ­ê°€ ì‚°ì ë„ ê·¸ë¦¬ê¸°
    plt.plot(pos_data_x, pos_data_y, "ro")
plt.xlabel("GDP per capita (USD)")
save_fig('money_happy_scatterplot')
plt.show()
```

    Saving figure money_happy_scatterplot
    


![output_32_1](https://user-images.githubusercontent.com/80252681/123362584-e4390c80-d5ab-11eb-9362-8b40cf28c72a.png)


**ì–¸ê¸‰ëœ 5ê°œ êµ­ê°€ì˜ 1ì¸ë‹¹ GDPì™€ ì‚¶ì˜ ë§Œì¡±ë„ë¥¼ ë°ì´í„°ì—ì„œ ì§ì ‘ í™•ì¸í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.**


```python
sample_data.loc[list(position_text.keys())]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GDP per capita</th>
      <th>Life satisfaction</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Hungary</th>
      <td>15372.885</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th>Korea</th>
      <td>30644.427</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>France</th>
      <td>39257.434</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>Australia</th>
      <td>51885.466</td>
      <td>7.3</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>63051.398</td>
      <td>6.9</td>
    </tr>
  </tbody>
</table>
</div>



# ì„ í˜• íšŒê·€ ëª¨ë¸

---


**ìœ„ ì‚°ì ë„ì— ë”°ë¥´ë©´ 1ì¸ë‹¹ GDPì™€ ì‚¶ì˜ ë§Œì¡±ë„ê°€ ì–´ëŠ ì •ë„ ì„ í˜• ê´€ê³„ì— ìˆëŠ” ê²ƒì²˜ëŸ¼ ë³´ì…ë‹ˆë‹¤.**

**ì•„ë˜ ë„í‘œì—ì„œ ê·¸ë ¤ì§„ ì„¸ ê°œì˜ ì§ì„  ì¤‘ì—ì„œ íŒŒë‘ìƒ‰ ì‹¤ì„ ì´ ì„ í˜• ê´€ê³„ë¥¼ ê°€ì¥ ì ì ˆí•˜ê²Œ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.**


```python
import numpy as np

sample_data.plot(kind='scatter', x="GDP per capita", y='Life satisfaction', figsize=(5,3))
plt.xlabel("GDP per capita (USD)")
plt.axis([0, 60000, 0, 10])
X=np.linspace(0, 60000, 1000)
plt.plot(X, 2*X/100000, "r")
plt.text(40000, 2.7, r"$\theta_0 = 0$", fontsize=14, color="r")
plt.text(40000, 1.8, r"$\theta_1 = 2 \times 10^{-5}$", fontsize=14, color="r")
plt.plot(X, 8 - 5*X/100000, "g")
plt.text(5000, 9.1, r"$\theta_0 = 8$", fontsize=14, color="g")
plt.text(5000, 8.2, r"$\theta_1 = -5 \times 10^{-5}$", fontsize=14, color="g")
plt.plot(X, 5 + 4*X/100000, "b")
plt.text(5000, 3.5, r"$\theta_0 = 5$", fontsize=14, color="b")
plt.text(5000, 2.6, r"$\theta_1 = 4 \times 10^{-5}$", fontsize=14, color="b")
save_fig('tweaking_model_params_plot')
plt.show()
```

    Saving figure tweaking_model_params_plot
    


![output_36_1](https://user-images.githubusercontent.com/80252681/123362611-ec914780-d5ab-11eb-92e5-1639a4986f9f.png)


**ì„ í˜•íšŒê·€ ëª¨ë¸ í›ˆë ¨**

- ì‚¶ì˜ë§Œì¡±ë„ = ğœƒ0 + ğœƒ1 Ã— 1ì¸ë‹¹GDP
- í›ˆë ¨ ë°ì´í„°ë„· ì§€ì •
 - íŠ¹ì„± ë°ì´í„°: 1ì¸ë‹¹ GDP
 - íƒ€ê¹ƒ ë°ì´í„°: ì‚¶ì˜ ë§Œì¡±ë„


```python
from sklearn import linear_model

# ì„ í˜•íšŒê·€ ëª¨ë¸ ì§€ì •
lin1 = linear_model.LinearRegression()

# í›ˆë ¨ ë°ì´í„°ì…‹ ì§€ì •
Xsample = np.c_[sample_data["GDP per capita"]]
ysample = np.c_[sample_data["Life satisfaction"]]

# ëª¨ë¸ í›ˆë ¨
lin1.fit(Xsample, ysample)
```




    LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=False)



**í›ˆë ¨ëœ ëª¨ë¸ì´ ì•Œì•„ë‚¸ ìµœì  ì„ í˜• ëª¨ë¸ì˜ ì ˆí¸ê³¼ ê¸°ìš¸ê¸°ëŠ” ì•„ë˜ ë‘ ì†ì„±ì— ì €ì¥í•©ë‹ˆë‹¤.**

- intercept_[0]: ì§ì„ ì˜ ì ˆí¸
- coef_[0]: ì§ì„ ì˜ ê¸°ìš¸ê¸°


```python
# ì˜ˆì¸¡ëœ ìµœì ì˜ ì§ì„ ì— ëŒ€í•œ ì •ë³´: ì ˆí¸ê³¼ ê¸°ìš¸ê¸°
t0, t1 = lin1.intercept_[0], lin1.coef_[0][0]

t0, t1
```




    (5.071121853750363, 4.1410177424136694e-05)



**2020ë…„ì—ì„œ êµ¬í•´ì§„ ì ˆí¸ì„ ì´ìš©í•˜ì—¬ ì‚°ì ë„ì™€ í•¨ê»˜ ê¸°ìš¸ê¸°ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.**


```python
# ì‚°ì ë„
sample_data.plot(kind='scatter', x="GDP per capita", y='Life satisfaction', figsize=(5,3))
plt.xlabel("GDP per capita (USD)")
plt.axis([0, 60000, 0, 10])

# ì§ì„  ê·¸ë¦¬ê¸°
X=np.linspace(0, 60000, 1000)
plt.plot(X, t0 + t1*X, "b")
# ì§ì„ ì˜ ì ˆí¸ê³¼ ê¸°ìš¸ê¸° ì •ë³´ ëª…ì‹œ
plt.text(5000, 3.1, r"$\theta_0 = 5.07$", fontsize=14, color="b")
plt.text(5000, 2.2, r"$\theta_1 = 4.14 \times 10^{-5}$", fontsize=14, color="b")

save_fig('best_fit_model_plot')
plt.show()
```

    Saving figure best_fit_model_plot
    


![output_42_1](https://user-images.githubusercontent.com/80252681/123362638-f5821900-d5ab-11eb-8eeb-0d8cd6a72703.png)


**í›ˆë ¨ ëª¨ë¸ í™œìš©**

í›ˆë ¨ëœ ëª¨ë¸ì„ ì´ìš©í•˜ì—¬ í•œ êµ­ê°€ì˜ ì‚¶ì˜ ë§Œì¡±ë„ë¥¼ 1ì¸ë‹¹ GDPë¥¼ ì´ìš©í•˜ì—¬ ì˜ˆì¸¡í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í‚¤í”„ëŸ¬ìŠ¤(Cyprus) 1ì¸ë‹¹ GDPë§Œ ë‹¤ìŒê³¼ ê°™ì´ ì•Œë ¤ì ¸ ìˆì„ ë•Œ í‚¤í”„ëŸ¬ìŠ¤ êµ­ë¯¼ì˜ ì‚¶ì˜ ë§Œì¡±ë„ë¥¼ ì˜ˆì¸¡í•œë‹¤.

- 2020ë…„ í‚¤í”„ëŸ¬ìŠ¤ 1ì¸ë‹¹ GDP: 26240


```python
cyprus_gdp_per_capita = gdp_per_capita.loc["Cyprus"]["GDP per capita"]
print(cyprus_gdp_per_capita)
```

    26240.048
    

**í‚¤í”„ëŸ¬ìŠ¤ êµ­ë¯¼ì˜ ì‚¶ì˜ ë§Œì¡±ë„ëŠ” 2020ë…„ ê¸°ì¤€ìœ¼ë¡œ 6.16ìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.**


```python
cyprus_predicted_life_satisfaction = lin1.predict([[cyprus_gdp_per_capita]])[0][0]
cyprus_predicted_life_satisfaction
```




    6.157726897048226



**ì•„ë˜ ë„í‘œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë“¯ì´ ì˜ˆì¸¡ê°’ì€ ì •í™•í•˜ê²Œ ì•ì„œ í™•ì¸í•œ ìµœì ì˜ ì§ì„  ìœ„ì— ìœ„ì¹˜í•©ë‹ˆë‹¤.**


```python
sample_data.plot(kind='scatter', x="GDP per capita", y='Life satisfaction', figsize=(5,3), s=1)
plt.xlabel("GDP per capita (USD)")

# ì˜ˆì¸¡ëœ ìµœì ì˜ ì§ì„ 
X=np.linspace(0, 60000, 1000)
plt.plot(X, t0 + t1*X, "b")
plt.axis([0, 60000, 0, 10])
plt.text(5000, 7.5, r"$\theta_0 = 5.07$", fontsize=14, color="b")
plt.text(5000, 6.6, r"$\theta_1 = 4.14 \times 10^{-5}$", fontsize=14, color="b")

# í‚¤í”„ëŸ¬ìŠ¤ì— ëŒ€í•œ ì‚¶ì˜ ë§Œì¡±ë„ ì˜ˆì¸¡ê°’

# ë¹¨ê°„ ì ì„  ê·¸ë¦¬ê¸°
plt.plot([cyprus_gdp_per_capita, cyprus_gdp_per_capita], [0, cyprus_predicted_life_satisfaction], "r--")
plt.text(30000, 5.0, r"Prediction = 6.16", fontsize=14, color="b")

# ì˜ˆì¸¡ ì§€ì  ì¢Œí‘œ ì°ê¸°(ë¹¨ê°„ìƒ‰)
plt.plot(cyprus_gdp_per_capita, cyprus_predicted_life_satisfaction, "ro")
save_fig('cyprus_prediction_plot')
plt.show()
```

    Saving figure cyprus_prediction_plot
    


![output_48_1](https://user-images.githubusercontent.com/80252681/123362656-fdda5400-d5ab-11eb-8de0-2c4eb73af9a0.png)


**ëŒ€í‘œì„±ì´ ì—†ëŠ” í›ˆë ¨ ë°ì´í„°**


---


**ëŒ€í‘œì„±ì´ ì—†ëŠ” ë°ì´í„° 7ê°€ì§€ë¥¼ í¬í•¨í•´ë´…ë‹ˆë‹¤.**
- Columbia(ì½œë¡¬ë¹„ì•„)
- Brazil(ë¸Œë¼ì§ˆ)
- Mexico(ë©•ì‹œì½”)
- Chille(ì¹ ë ˆ)
- Ireland(ì•„ì¼ëœë“œ)
- Switzerland(ìŠ¤ìœ„ìŠ¤)
- Luxembourg(ë£©ì…ˆë¶€ë¥´í¬)


```python
missing_data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GDP per capita</th>
      <th>Life satisfaction</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Colombia</th>
      <td>5207.238</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>Brazil</th>
      <td>6450.451</td>
      <td>6.4</td>
    </tr>
    <tr>
      <th>Mexico</th>
      <td>8069.104</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>Chile</th>
      <td>12612.322</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>Ireland</th>
      <td>79668.502</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>Switzerland</th>
      <td>81867.462</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>Luxembourg</th>
      <td>109602.322</td>
      <td>6.9</td>
    </tr>
  </tbody>
</table>
</div>



**ì•„ë˜ ì¢Œí‘œëŠ” 7ê°œ êµ­ê°€ëª…ì„ ì•„ë˜ ë„í‘œì—ì„œ í‘œê¸°í•  ë•Œ ì‚¬ìš©í•  ì¢Œí‘œì…ë‹ˆë‹¤.**


```python
position_text2 = {
    "Colombia": (1000, 9.0),
    "Brazil": (11000, 9.0),
    "Mexico": (25000, 9.0),
    "Chile": (35000, 9.0),
    "Ireland": (60000, 3),
    "Switzerland": (72000, 3.0),
    "Luxembourg": (90000, 3.0),
}
```

**7ê°œ êµ­ê°€ë¥¼ í¬í•¨í•œ ì „ì²´ í›ˆë ¨ ë°ì´í„°ì…‹ì„ ì´ìš©í•˜ì—¬ í›ˆë ¨í•œ ê²°ê³¼ë¥¼ 7ê°œ êµ­ê°€ë¥¼ ì œì™¸í–ˆì„ ë•Œì˜ í›ˆë ¨ ê²°ê³¼ì™€ ë¹„êµí•©ë‹ˆë‹¤.**

- ê²€ì • ì‹¤ì„ : 7ê°œ êµ­ê°€ í¬í•¨ ì˜ˆì¸¡ ì„ í˜• ëª¨ë¸
- íŒŒë‘ ì ì„ : 7ê°œ êµ­ê°€ ì œì™¸ ì˜ˆì¸¡ ì„ í˜• ëª¨ë¸

**ê²°ë¡  : ì„ í˜•íšŒê·€ ëª¨ë¸ì€ 1ì¸ë‹¹ GDPì™€ ì‚¶ì˜ ë§Œì¡±ë„ ì‚¬ì´ì˜ ê´€ê³„ë¥¼ ëª¨ë¸ë§ í•˜ê¸°ì— ë¶€ì í•©ë‹ˆë‹¤.**


```python
# 7ê°œ êµ­ê°€ë¥¼ ì œì™¸í•œ êµ­ê°€ë“¤ì˜ ì‚°ì ë„ (íŒŒë‘ìƒ‰ ì )
sample_data.plot(kind='scatter', x="GDP per capita", y='Life satisfaction', figsize=(8,3))
plt.axis([0, 110000, 0, 10])

# 7ê°œ êµ­ê°€ ì‚°ì ë„(ë¹¨ê°• ì )
for country, pos_text in position_text2.items():
    pos_data_x, pos_data_y = missing_data.loc[country]
    # 7ê°œ êµ­ê°€ëª… í‘œê¸°
    plt.annotate(country, xy=(pos_data_x, pos_data_y), xytext=pos_text,
            arrowprops=dict(facecolor='black', width=0.5, shrink=0.1, headwidth=5))
    plt.plot(pos_data_x, pos_data_y, "rs")

# 7ê°œ êµ­ê°€ ì œì™¸ ì˜ˆì¸¡ ì„ í˜• ëª¨ë¸ ê·¸ë˜í”„ (íŒŒë‘ ì ì„ )
X=np.linspace(0, 110000, 1000)
plt.plot(X, t0 + t1*X, "b:")

# 7ê°œ êµ­ê°€ í¬í•¨ ì„ í˜•íšŒê·€ ëª¨ë¸ í›ˆë ¨ ë° ì˜ˆì¸¡
lin_reg_full = linear_model.LinearRegression()
Xfull = np.c_[full_country_stats["GDP per capita"]]
yfull = np.c_[full_country_stats["Life satisfaction"]]
lin_reg_full.fit(Xfull, yfull)

# 7ê°œ êµ­ê°€ í¬í•¨ ì˜ˆì¸¡ ì„ í˜• ëª¨ë¸ ê·¸ë˜í”„(ê²€ì • ì‹¤ì„ )
t0full, t1full = lin_reg_full.intercept_[0], lin_reg_full.coef_[0][0]
X = np.linspace(0, 110000, 1000)
plt.plot(X, t0full + t1full * X, "k")
plt.xlabel("GDP per capita (USD)")

save_fig('representative_training_data_scatterplot')
plt.show()
```

    Saving figure representative_training_data_scatterplot
    


![output_54_1](https://user-images.githubusercontent.com/80252681/123362686-092d7f80-d5ac-11eb-8bc2-8e798871a467.png)



# ê³¼ëŒ€ì í•©ê³¼ ëª¨ë¸ê·œì œ


---
**ê³¼ëŒ€ ì í•©**

í›ˆë ¨ëœ ëª¨ë¸ì´ í›ˆë ¨ë°ì´í„°ì—ëŠ” ë„ˆë¬´ë‚˜ë„ ì˜ ë§ì§€ë§Œ ìƒˆë¡œìš´ ë°ì´í„°ì— ëŒ€í•´ì„œëŠ” ì˜ ì‘ë™í•˜ì§€ ì•Šì„ ë•Œ í•´ë‹¹ ëª¨ë¸ì´ í›ˆë ¨ë°ì´í„°ì— ê³¼ëŒ€ì í•©ë˜ì—ˆë‹¤ê³  ë§í•œë‹¤.

ê³ ì°¨í•­ ë‹¤í•­íšŒê·€ë¥¼ ì´ìš©í•˜ì—¬ ì„ í˜•ì´ ì•„ë‹ˆë¼ 60ì°¨ ë‹¤í•­ì‹ì˜ ê·¸ë˜í”„ë¡œ ëª¨ë¸ì„ ì˜ˆì¸¡í•œë‹¤. ê²°ê³¼ëŠ” í›ˆë ¨ë°ì´í„°ì…‹ì— ë§¤ìš° ì˜ ë“¤ì–´ë§ì§€ë§Œ, ìƒˆë£¨ìš´ ë°ì´í„°ì— ëŒ€í•´ í›ˆë ¨ëœ ëª¨ë¸ì´ ì œëŒ€ë¡œëœ ì˜ˆì¸¡ì„ í•  ìˆ˜ ìˆì„ ê±°ë¼ê³  ë¯¿ê¸°ëŠ” ì–´ë µë‹¤. ì´ëŸ° ëª¨ë¸ì€ ì¼ë°˜í™”ê°€ ì–´ë µë‹¤ë¼ê³  ë§í•œë‹¤.


```python
full_country_stats.plot(kind='scatter', x="GDP per capita", y='Life satisfaction', figsize=(8,3))
plt.axis([0, 110000, 0, 10])

from sklearn import preprocessing
from sklearn import pipeline

poly = preprocessing.PolynomialFeatures(degree=60, include_bias=False)
scaler = preprocessing.StandardScaler()
lin_reg2 = linear_model.LinearRegression()

pipeline_reg = pipeline.Pipeline([('poly', poly), ('scal', scaler), ('lin', lin_reg2)])
pipeline_reg.fit(Xfull, yfull)
curve = pipeline_reg.predict(X[:, np.newaxis])
plt.plot(X, curve)
plt.xlabel("GDP per capita (USD)")
save_fig('overfitting_model_plot')
plt.show()
```

    /usr/local/lib/python3.7/dist-packages/numpy/lib/nanfunctions.py:1544: RuntimeWarning: overflow encountered in multiply
      sqr = np.multiply(arr, arr, out=arr)
    

    Saving figure overfitting_model_plot
    


![output_56_2](https://user-images.githubusercontent.com/80252681/123362712-10548d80-d5ac-11eb-8bfc-0e977ae510e4.png)


**í›ˆë ¨ì„¸íŠ¸ì— ì¡ìŒì´ ë§ì´ ìˆê±°ë‚˜ ë°ì´í„°ì…‹ì´ ë„ˆë¬´ ì‘ìœ¼ë©´ í›ˆë ¨ ê³¼ì •ì—ì„œ ë³„ë¡œ ìƒê´€ ì—†ëŠ” íŠ¹ì„±ì„ ì´ìš©í•˜ë ¤ê³  ì‹œë„í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.**

**OECDì— ì†í•˜ëŠ” êµ­ê°€ ì¤‘ì—ì„œ ë‚˜ë¼ ì´ë¦„ì— ì˜ì–´ ì•ŒíŒŒë²³ Wê°€ í¬í•¨ëœ ì•„ë˜ì˜ ë‚˜ë¼ì˜ ì‚¶ì˜ ë§Œì¡±ë„ê°€ ë§¤ìš° ë†’ì€ í¸ì…ë‹ˆë‹¤.**


```python
full_country_stats.loc[[c for c in full_country_stats.index if "W" in c.upper()]]["Life satisfaction"]
```




    Country
    New Zealand    7.3
    Sweden         7.3
    Norway         7.6
    Switzerland    7.5
    Name: Life satisfaction, dtype: float64



**í•˜ì§€ë§Œ ê·¸ë ‡ë‹¤í•´ì„œ ë‚˜ë¼ëª…ì— ì˜ì–´ ì•ŒíŒŒë²³ Wê°€ í¬í•¨ëœ ëª¨ë“  ë‚˜ë¼ì˜ ì‚¶ì˜ ë§Œì¡±ë„ê°€ ë†’ë‹¤ê³  ê²°ë¡  ì§€ì„ ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤.**

**ì‹¤ì œë¡œ ì˜ì–´ ì•ŒíŒŒë²³ Wë¥¼ í¬í•¨í•œ êµ­ê°€ ì¤‘ì— ì—¬ëŸ¬ êµ­ê°€ì˜ 1ì¸ë‹¹ GDPê°€ ì•„ë˜ ì½”ë“œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´ ë§¤ìš° ë‚®ìŠµë‹ˆë‹¤.**

**ì˜ˆë¥¼ ë“¤ì–´, ë£¨ì™„ë‹¤(Rwanda), ì§ë°”ë¸Œì›¨(Zimbabwe) ë“±ì˜ êµ­ê°€ì˜ ì‚¶ì˜ ë§Œì¡±ë„ë¥¼ ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³  ë§¤ìš° ë†’ë‹¤ê³  ë§í•  ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤.**


```python
gdp_per_capita.loc[[c for c in gdp_per_capita.index.astype(str) if "W" in c.upper()]].head()

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Subject Descriptor</th>
      <th>Units</th>
      <th>Scale</th>
      <th>Country/Series-specific Notes</th>
      <th>GDP per capita</th>
      <th>Estimates Start After</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Botswana</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>6557.505</td>
      <td>2017.0</td>
    </tr>
    <tr>
      <th>Eswatini</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>3414.805</td>
      <td>2017.0</td>
    </tr>
    <tr>
      <th>Kuwait</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>22252.431</td>
      <td>2018.0</td>
    </tr>
    <tr>
      <th>Malawi</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>399.097</td>
      <td>2011.0</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>38675.319</td>
      <td>2019.0</td>
    </tr>
  </tbody>
</table>
</div>



**ëª¨ë¸ ê·œì œ**

'ê·œì œê°€ ìˆëŠ” ì„ í˜• ëª¨ë¸'ì—ì„œ ë‹¤ë£¨ëŠ” ì´ìš©í•˜ë©´ ê³¼ëŒ€ì í•©ì˜ ìœ„í—˜ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ ê³¼ëŒ€ì í•©ì˜ ìœ„í—˜ì„ ê°ì†Œì‹œí‚¤ê¸° ìœ„ì— í›ˆë ¨ ëª¨ë¸ì— ì œì•½ì„ ê°€í•˜ëŠ” ê²ƒì„ ê·œì œ(regularization)ë¼ê³  í•œë‹¤.

ì•„ë˜ ì½”ë“œëŠ” ì„¸ ê°œì˜ ëª¨ë¸ì„ ë¹„êµí•œë‹¤.

- ë¹¨ê°• íŒŒì„ : 7ê°œ êµ­ê°€ í¬í•¨ ì˜ˆì¸¡ ì„ í˜• ëª¨ë¸
- íŒŒë‘ ì ì„ : 7ê°œ êµ­ê°€ ì œì™¸ ì˜ˆì¸¡ ì„ í˜• ëª¨ë¸
- íŒŒë‘ ì‹¤ì„ : 7ê°œ êµ­ê°€ ì œì™¸ ê·œì œ ì ìš© ì˜ˆì¸¡ ì„ í˜• ëª¨ë¸
 - ê·œì œ ë°©ì‹: Ridge ê·œì œ

7ê°œ êµ­ê°€ë¥¼ ì œì™¸í•˜ë”ë¼ë„ ëª¨ë¸ì— ê·œì œë¥¼ ì ìš©í•˜ë©´ ë°ì´í„°ì— ëœ ê³¼ëŒ€ì í•©í•œ ëª¨ë¸ì„ ì–»ê²Œ ë¨ì„ ì„¸ ê°œì˜ ê·¸ë˜í”„ë¥¼ ë¹„êµí•´ì„œ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.


```python
plt.figure(figsize=(8,3))

plt.xlabel("GDP per capita")
plt.ylabel('Life satisfaction')

# 7ê°œ êµ­ê°€ ì œì™¸ ë°ì´í„° ì‚°ì ë„(íŒŒë‘ ë™ê·¸ë¼ë¯¸)
plt.plot(list(sample_data["GDP per capita"]), list(sample_data["Life satisfaction"]), "bo")
# ì œì™¸ëœ 7ê°œ êµ­ê°€ ì‚°ì ë„(ë¹¨ê°• ë„¤ëª¨)
plt.plot(list(missing_data["GDP per capita"]), list(missing_data["Life satisfaction"]), "rs")

# 7ê°œ êµ­ê°€ í¬í•¨ ì˜ˆì¸¡ ì„ í˜• ëª¨ë¸ ê·¸ë˜í”„(ë¹¨ê°• íŒŒì„ )
X = np.linspace(0, 110000, 1000)
plt.plot(X, t0full + t1full * X, "r--", label="Linear model on all data")
# 7ê°œ êµ­ê°€ ì œì™¸ ì˜ˆì¸¡ ì„ í˜• ëª¨ë¸ ê·¸ë˜í”„(íŒŒë‘ ì ì„ )
plt.plot(X, t0 + t1*X, "b:", label="Linear model on partial data")

# ë¦¿ì§€(Ridge) ê·œì œ ì ìš© í›ˆë ¨: 7ê°œ êµ­ê°€ ì œì™¸ ë°ì´í„° ëŒ€ìƒ
ridge = linear_model.Ridge(alpha=10**9.5)
Xsample = np.c_[sample_data["GDP per capita"]]
ysample = np.c_[sample_data["Life satisfaction"]]
ridge.fit(Xsample, ysample)
# ë¦¿ì§€ ê·œì œ ì ìš© ì˜ˆì¸¡ ì„ í˜• ëª¨ë¸ ê·¸ë˜í”„(íŒŒë‘ ì‹¤ì„ )
t0ridge, t1ridge = ridge.intercept_[0], ridge.coef_[0][0]
plt.plot(X, t0ridge + t1ridge * X, "b", label="Regularized linear model on partial data")

plt.legend(loc="lower right")
plt.axis([0, 110000, 0, 10])
plt.xlabel("GDP per capita (USD)")
save_fig('ridge_model_plot')
plt.show()
```

    Saving figure ridge_model_plot
    


![output_62_1](https://user-images.githubusercontent.com/80252681/123362747-1f3b4000-d5ac-11eb-8e43-ebcc3faf6b56.png)


# k-ìµœê·¼ì ‘ ì´ì›ƒ ëª¨ë¸

---


**ì‚¬ë¡€ê¸°ë°˜ í•™ìŠµ**

í‚¤í”„ëŸ¬ìŠ¤ì˜ ì‚¶ì˜ ë§Œì¡±ë„ë¥¼ ì‚¬ë¡€ ê¸°ë°˜ í•™ìŠµìœ¼ë¡œ ì˜ˆì¸¡í•˜ê¸° ìœ„í•´ 1ì¸ë‹¹ GDPê°€ í‚¤í”„ëŸ¬ìŠ¤ì˜ ê²½ìš°ê°€ ê°€ì¥ ê°€ê¹Œìš´ êµ­ê°€ë“¤ì˜ ì‚¶ì˜ ë§Œì¡±ë„ì˜ í‰ê· ê°’ì„ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**2020ë…„ í‚¤í”„ëŸ¬ìŠ¤ 1ì¸ë‹¹ GDP: 26240**

ì˜ˆë¥¼ ë“¤ì–´, í‚¤í”„ëŸ¬ìŠ¤ì˜ 1ì¸ë‹¹ GDPì™€ ê°€ì¥ ê°€ê¹Œìš´ ì„¸ ë‚˜ë¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

- ìŠ¬ë¡œë² ë‹ˆì•„(Slovenia)
- ìŠ¤í˜ì¸(Spain)
- í•œêµ­(Korea)


```python
sample_data[12:15]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GDP per capita</th>
      <th>Life satisfaction</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Slovenia</th>
      <td>25038.792</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>Spain</th>
      <td>26831.629</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>Korea</th>
      <td>30644.427</td>
      <td>5.9</td>
    </tr>
  </tbody>
</table>
</div>



**ìœ„ ì„¸ ë‚˜ë¼ì˜ ì‚¶ì˜ ë§Œì¡±ë„ì˜ í‰ê· ê°’ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.**


```python
(5.9 + 6.3 + 5.9)/3
```




    6.033333333333334



ì•ì„œ ì„¤ëª…í•œ ì•Œê³ ë¦¬ì¦˜ì„ k-ìµœê·¼ì ‘ ì´ì›ƒ íšŒê·€ë¼ê³  í•˜ë©°, ìœ„ ì˜ˆì œì—ì„œ ì‚¬ìš©ëœ këŠ” 3ì…ë‹ˆë‹¤.

ì‚¬ì´í‚·ëŸ°ì—ì„œ ì§€ì›í•˜ëŠ” k-ìµœê·¼ì ‘ ì´ì›ƒ íšŒê·€ëª¨ë¸ì„ ì ìš©í•˜ë©´ ë°˜ì˜¬ë¦¼í•˜ë©´ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ê²Œ ë©ë‹ˆë‹¤.

- n_neighbors = 3: ì˜ˆì¸¡í•  ë°ì´í„°ì™€ ê°€ì¥ ê°€ê¹Œìš´ 3ê°œì˜ í›ˆë ¨ ë°ì´í„° ì •ë³´ë¥¼ í™œìš©í•œë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.

**6.03 ê³¼ 5.96ì´ë¯€ë¡œ 6ìœ¼ë¡œ ì¼ì¹˜í•œë‹¤ê³  ë³¼ ìˆ˜ ìˆìŒ**


```python
import sklearn.neighbors
model = sklearn.neighbors.KNeighborsRegressor(n_neighbors=3)
```


```python
X = np.c_[sample_data["GDP per capita"]]
y = np.c_[sample_data["Life satisfaction"]]

# ëª¨ë¸ í›ˆë ¨
model.fit(X, y)

# í‚¤í”„ëŸ¬ìŠ¤ êµ­ê°€ì— ëŒ€í•œ ì˜ˆì¸¡í•˜ê¸°
X_new = np.array([[26240.048]])  # Cyprus' GDP per capita
print(model.predict(X_new)) # outputs [[ 6.033333333333334]]
```

    [[5.96666667]]
    
